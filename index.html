<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vitro Troubleshooter</title>
    <style>
        /* ===== GRUNDLEGENDES DESIGN ===== */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            color: #333;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }

        /* ===== HEADER ===== */
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
        }

        .header p {
            font-size: 1.1em;
            opacity: 0.9;
        }

        /* ===== PROGRESS BAR ===== */
        .progress-container {
            background: #f0f0f0;
            padding: 20px 30px;
            border-bottom: 1px solid #ddd;
        }

        .progress-bar {
            height: 8px;
            background: #e0e0e0;
            border-radius: 10px;
            overflow: hidden;
            margin-bottom: 10px;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
            width: 0%;
            transition: width 0.3s ease;
        }

        .progress-text {
            text-align: center;
            color: #666;
            font-size: 0.9em;
        }

        /* ===== CONTENT BEREICH ===== */
        .content {
            padding: 40px;
        }

        .step {
            display: none;
            animation: fadeIn 0.3s ease;
        }

        .step.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .question {
            font-size: 1.5em;
            color: #667eea;
            margin-bottom: 30px;
            font-weight: 600;
        }

        /* ===== BUTTONS ===== */
        .button-group {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-top: 20px;
        }

        .btn {
            padding: 18px 30px;
            border: none;
            border-radius: 12px;
            font-size: 1.1em;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
            text-align: left;
            background: white;
            border: 2px solid #667eea;
            color: #667eea;
        }

        .btn:hover {
            background: #667eea;
            color: white;
            transform: translateX(5px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
        }

        .btn-primary:hover {
            transform: scale(1.02);
            box-shadow: 0 8px 20px rgba(102, 126, 234, 0.4);
        }

        /* ===== INPUT FELDER ===== */
        .input-group {
            margin: 20px 0;
        }

        .input-group label {
            display: block;
            margin-bottom: 8px;
            color: #666;
            font-weight: 600;
        }

        .input-group input,
        .input-group select {
            width: 100%;
            padding: 15px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 1em;
            transition: border-color 0.3s ease;
        }

        .input-group input:focus,
        .input-group select:focus {
            outline: none;
            border-color: #667eea;
        }

        /* ===== INFO BOXEN ===== */
        .info-box {
            padding: 20px;
            border-radius: 12px;
            margin: 20px 0;
            border-left: 5px solid;
        }

        .info-box.tip {
            background: #e3f2fd;
            border-color: #2196F3;
            color: #1565C0;
        }

        .info-box.warning {
            background: #fff3e0;
            border-color: #FF9800;
            color: #E65100;
        }

        .info-box.success {
            background: #e8f5e9;
            border-color: #4CAF50;
            color: #2E7D32;
        }

        .info-box.error {
            background: #ffebee;
            border-color: #f44336;
            color: #c62828;
        }

        .info-box strong {
            display: block;
            margin-bottom: 8px;
            font-size: 1.1em;
        }

        /* ===== LED STATUS ===== */
        .led-status {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 8px;
            margin: 10px 0;
        }

        .led-indicator {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            box-shadow: 0 0 10px rgba(0,0,0,0.2);
        }

        .led-indicator.green { background: #4CAF50; box-shadow: 0 0 10px #4CAF50; }
        .led-indicator.red { background: #f44336; box-shadow: 0 0 10px #f44336; }
        .led-indicator.orange { background: #FF9800; box-shadow: 0 0 10px #FF9800; }
        .led-indicator.off { background: #666; }

        /* ===== RESULT BOX ===== */
        .result-box {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 12px;
            margin: 20px 0;
            border: 2px solid #667eea;
        }

        .result-box h3 {
            color: #667eea;
            margin-bottom: 15px;
        }

        .result-box pre {
            background: white;
            padding: 15px;
            border-radius: 8px;
            overflow-x: auto;
            white-space: pre-wrap;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            line-height: 1.6;
        }

        .copy-btn {
            margin-top: 15px;
            padding: 12px 25px;
            background: #4CAF50;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .copy-btn:hover {
            background: #45a049;
            transform: scale(1.05);
        }

        .copy-btn:active {
            transform: scale(0.98);
        }

        /* ===== NAVIGATION BUTTONS ===== */
        .nav-buttons {
            display: flex;
            gap: 15px;
            margin-top: 30px;
        }

        .btn-back {
            padding: 12px 25px;
            background: #6c757d;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .btn-back:hover {
            background: #5a6268;
        }

        .btn-restart {
            padding: 12px 25px;
            background: #dc3545;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .btn-restart:hover {
            background: #c82333;
        }

        /* ===== CHECKLIST ===== */
        .checklist {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 12px;
            margin: 20px 0;
        }

        .checklist-item {
            padding: 12px;
            margin: 8px 0;
            background: white;
            border-radius: 8px;
            border-left: 4px solid #667eea;
        }

        .checklist-item input[type="checkbox"] {
            margin-right: 10px;
            width: 18px;
            height: 18px;
            cursor: pointer;
        }

        /* ===== RESPONSIVE (minimal, da kein Mobile) ===== */
        @media (max-width: 768px) {
            .container {
                border-radius: 0;
            }
            
            .content {
                padding: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- HEADER -->
        <div class="header">
            <h1>‚ö° Vitro Troubleshooter</h1>
            <p>Schnelle L√∂sung f√ºr VitroConnect-Tickets</p>
        </div>

        <!-- PROGRESS BAR -->
        <div class="progress-container">
            <div class="progress-bar">
                <div class="progress-fill" id="progressBar"></div>
            </div>
            <div class="progress-text" id="progressText">Schritt 1 von 10</div>
        </div>

        <!-- CONTENT -->
        <div class="content">
            <!-- STEP 1: LineOwner Check -->
            <div class="step active" id="step1">
                <h2 class="question">üéØ Schritt 1: LineOwner identifizieren</h2>
                
                <div class="info-box tip">
                    <strong>üí° Tipp:</strong>
                    Kundennummer in TITAN eingeben ‚Üí LineID anzeigen lassen
                </div>

                <div class="input-group">
                    <label for="lineId">LineID eingeben (optional, zur Dokumentation):</label>
                    <input type="text" id="lineId" placeholder="z.B. VITR123456">
                </div>

                <div class="button-group">
                    <button class="btn" onclick="setLineOwner('UGG')">
                        üîµ UGG (UGG GmbH & Co. KG)
                    </button>
                    <button class="btn" onclick="setLineOwner('EWE')">
                        üü¢ EWE (EWE Tel GmbH)
                    </button>
                    <button class="btn" onclick="setLineOwner('Vitro')">
                        üü£ Vitro (vitroconnect GmbH)
                    </button>
                </div>

                <div class="info-box warning" style="margin-top: 20px;">
                    <strong>‚ö†Ô∏è Wichtig:</strong>
                    Der LineOwner bestimmt, an wen du St√∂rungen eskalierst!
                </div>
            </div>

            <!-- STEP 2: Aktivit√§t Check -->
            <div class="step" id="step2">
                <h2 class="question">üìÖ Schritt 2: Aktivit√§t pr√ºfen</h2>
                
                <div class="info-box tip">
                    <strong>üí° Wie pr√ºfen?</strong>
                    In TITAN die letzten 7 Tage auf Verbindungsaktivit√§t checken
                </div>

                <div class="button-group">
                    <button class="btn" onclick="setActivity('yes')">
                        ‚úÖ JA - Aktivit√§t vorhanden ‚Üí St√∂rung
                    </button>
                    <button class="btn" onclick="setActivity('no')">
                        ‚ùå NEIN - Keine Aktivit√§t ‚Üí Anschaltung
                    </button>
                    <button class="btn" onclick="setActivity('unsure')">
                        ‚ùì UNSICHER - Kunde kontaktieren n√∂tig
                    </button>
                </div>

                <div class="info-box warning" style="margin-top: 20px;">
                    <strong>‚ö†Ô∏è Sonderf√§lle:</strong>
                    <ul style="margin-top: 10px; padding-left: 20px;">
                        <li>Kunde war 1 Monat im Urlaub + Ausfall > 7 Tage = trotzdem St√∂rung</li>
                        <li>Anschaltung vor 2 Monaten, aber nie im Betrieb = Anschaltung</li>
                        <li>Bei Unsicherheit: IMMER erst mit Kunde telefonieren!</li>
                    </ul>
                </div>
            </div>

            <!-- STEP 2b: Anschaltdatum Check (wenn keine Aktivit√§t) -->
            <div class="step" id="step2b">
                <h2 class="question">üìã Anschaltdatum im Ticket?</h2>
                
                <div class="info-box tip">
                    <strong>üí° Wo finden?</strong>
                    <ul style="margin-top: 10px; padding-left: 20px;">
                        <li>Steht meist drin, wenn Ticket von Hotline kam</li>
                        <li>Fehlt oft bei Tickets aus "o2 my service" App</li>
                        <li>Dann: Infos manuell zusammensuchen</li>
                    </ul>
                </div>

                <div class="button-group">
                    <button class="btn" onclick="setAnschaltdatum('yes')">
                        ‚úÖ JA - Anschaltdatum bekannt ‚Üí Weiter
                    </button>
                    <button class="btn" onclick="setAnschaltdatum('no')">
                        ‚ùå NEIN - Kunde kontaktieren n√∂tig
                    </button>
                </div>
            </div>

            <!-- STEP 3: St√∂rungstyp w√§hlen -->
            <div class="step" id="step3">
                <h2 class="question">üîç Schritt 3: St√∂rungstyp w√§hlen</h2>
                
                <div class="button-group">
                    <button class="btn" onclick="setTicketType('anschaltung')">
                        üÜï FTTH-Anschaltung (Ersteinrichtung)
                    </button>
                    <button class="btn" onclick="setTicketType('komplettausfall')">
                        üî¥ Komplettausfall (Kunde komplett offline)
                    </button>
                    <button class="btn" onclick="setTicketType('sporadisch')">
                        üü° Sporadische Ausf√§lle (immer wieder Abbr√ºche)
                    </button>
                    <button class="btn" onclick="setTicketType('performance')">
                        üêå Performance-Probleme (langsame Verbindung)
                    </button>
                </div>
            </div>

            <!-- STEP 4: Router-Modell (f√ºr Anschaltung) -->
            <div class="step" id="step4-router">
                <h2 class="question">üì¶ Router-Modell?</h2>
                
                <div class="info-box tip">
                    <strong>üí° Warum wichtig?</strong>
                    Homebox und Fritzbox haben unterschiedliche Men√ºs!
                </div>

                <div class="button-group">
                    <button class="btn" onclick="setRouterModel('fritzbox')">
                        üî¥ Fritzbox (alle Modelle)
                    </button>
                    <button class="btn" onclick="setRouterModel('homebox')">
                        ‚ö™ Homebox 3
                    </button>
                    <button class="btn" onclick="setRouterModel('other')">
                        ‚ùì Anderer Router (Dritthersteller)
                    </button>
                </div>
            </div>

            <!-- STEP 5: Verkabelung pr√ºfen -->
            <div class="step" id="step5-verkabelung">
                <h2 class="question">üîå Verkabelung pr√ºfen</h2>
                
                <div class="info-box warning">
                    <strong>‚ö†Ô∏è WICHTIG:</strong>
                    Falsche Verkabelung = h√§ufigster Fehler bei Anschaltungen!
                </div>

                <div class="checklist">
                    <h3 style="margin-bottom: 15px;">‚úÖ Checkliste mit Kunde durchgehen:</h3>
                    <div class="checklist-item">
                        <input type="checkbox" id="check1">
                        <label for="check1">Glasfaserkabel von Wand ‚Üí ONT (blaues/gr√ºnes Kabel)</label>
                    </div>
                    <div class="checklist-item">
                        <input type="checkbox" id="check2">
                        <label for="check2">Netzwerkkabel ONT ‚Üí Router (meist gelbes LAN-Kabel)</label>
                    </div>
                    <div class="checklist-item">
                        <input type="checkbox" id="check3">
                        <label for="check3">Strom am ONT angeschlossen</label>
                    </div>
                    <div class="checklist-item">
                        <input type="checkbox" id="check4">
                        <label for="check4">Strom am Router angeschlossen</label>
                    </div>
                </div>

                <div class="button-group">
                    <button class="btn" onclick="checkVerkabelung('mit-ont')">
                        ‚úÖ Mit ONT (Standard bei VitroConnect)
                    </button>
                    <button class="btn" onclick="checkVerkabelung('ohne-ont')">
                        üîÑ Ohne ONT (Glasfaser direkt in Router)
                    </button>
                </div>
            </div>

            <!-- STEP 6: ONT LED Status -->
            <div class="step" id="step6-ont">
                <h2 class="question">üí° ONT LED-Status pr√ºfen</h2>
                
                <div class="info-box tip">
                    <strong>üí° Was sagt uns der ONT?</strong>
                    Die LEDs zeigen, wo genau das Problem liegt!
                </div>

                <h3 style="margin: 20px 0;">Welche LEDs leuchten?</h3>

                <div class="led-status">
                    <div class="led-indicator green"></div>
                    <div>
                        <strong>Power:</strong> Betriebsbereitschaft<br>
                        <small style="color: #666;">Muss AN sein, sonst kein Strom!</small>
                    </div>
                </div>

                <div class="led-status">
                    <div class="led-indicator green"></div>
                    <div>
                        <strong>Sync / Connection:</strong> Kommunikation nach au√üen<br>
                        <small style="color: #666;">Muss AN sein f√ºr Internet</small>
                    </div>
                </div>

                <div class="led-status">
                    <div class="led-indicator green"></div>
                    <div>
                        <strong>ETH:</strong> Verbindung zum Router<br>
                        <small style="color: #666;">Sollte AN oder BLINKEN</small>
                    </div>
                </div>

                <div class="led-status">
                    <div class="led-indicator off"></div>
                    <div>
                        <strong>Alarm:</strong> St√∂rungsanzeige<br>
                        <small style="color: #666;">Sollte AUS sein (grau/schwarz)</small>
                    </div>
                </div>

                <h3 style="margin: 30px 0 15px 0;">Aktueller Status:</h3>
                
                <div class="button-group">
                    <button class="btn" onclick="setONTStatus('normal')">
                        ‚úÖ Alles gr√ºn, nur Alarm aus ‚Üí Normalbetrieb
                    </button>
                    <button class="btn" onclick="setONTStatus('anschaltung')">
                        üü° Power AN, Sync AUS, ETH blinkt, Alarm ROT<br>
                        <small style="display: block; margin-top: 5px; opacity: 0.7;">
                        ‚Üí Typisch bei Anschaltung (ONT bereit, kein Signal von UGG)
                        </small>
                    </button>
                    <button class="btn" onclick="setONTStatus('kein-strom')">
                        üî¥ Power AUS ‚Üí Kein Strom am ONT
                    </button>
                    <button class="btn" onclick="setONTStatus('kein-sync')">
                        üü† Power AN, Sync AUS, Alarm ROT<br>
                        <small style="display: block; margin-top: 5px; opacity: 0.7;">
                        ‚Üí Leitungsproblem (UGG muss pr√ºfen)
                        </small>
                    </button>
                </div>
            </div>

            <!-- STEP 7: Router konfigurieren (Fritzbox) -->
            <div class="step" id="step7-fritzbox">
                <h2 class="question">‚öôÔ∏è Fritzbox konfigurieren</h2>
                
                <div class="info-box warning">
                    <strong>‚ö†Ô∏è WICHTIG bei Anschaltung:</strong>
                    Router TROTZDEM einrichten, auch wenn ONT noch kein Signal hat!<br>
                    <strong>Vorteil:</strong> Sobald UGG das Signal schaltet, ist Kunde sofort online!
                </div>

                <div class="result-box">
                    <h3>üìã Fritzbox-Konfiguration (mit ONT):</h3>
                    <ol style="line-height: 2; padding-left: 20px;">
                        <li><strong>http://fritz.box</strong> aufrufen</li>
                        <li><strong>Internet ‚Üí Zugangsdaten ‚Üí Anbieter</strong></li>
                        <li><strong>o2</strong> ausw√§hlen</li>
                        <li>
                            <strong>Manchmal erscheinen 2 Reiter</strong> (OS-abh√§ngig):<br>
                            ‚Üí <strong>"Glasfaser"</strong> anklicken
                        </li>
                        <li>
                            <strong>Zugangsart:</strong> o2 FTTH ausw√§hlen<br>
                            <small style="color: #666;">(Feld erscheint nur bei Anschluss √ºber ONT/WAN/LAN1)</small>
                        </li>
                        <li><strong>Benutzername:</strong> leer lassen</li>
                        <li><strong>Kennwort:</strong> leer lassen</li>
                        <li><strong>√úbernehmen</strong> klicken</li>
                        <li>Router startet neu (ca. 2 Minuten warten)</li>
                    </ol>
                </div>

                <div class="info-box tip">
                    <strong>üí° Ohne ONT (Direktanschluss)?</strong>
                    Dann erscheint statt "Zugangsart" das Feld:<br>
                    <strong>"ONT-Installationskennung"</strong><br>
                    ‚Üí Diese aus VitroConnect Tool √ºbernehmen
                </div>

                <div class="button-group">
                    <button class="btn-primary btn" onclick="nextStep('step8-verbindung')">
                        ‚û°Ô∏è Weiter zur Verbindungspr√ºfung
                    </button>
                </div>
            </div>

            <!-- STEP 7b: Router konfigurieren (Homebox) -->
            <div class="step" id="step7-homebox">
                <h2 class="question">‚öôÔ∏è Homebox konfigurieren</h2>
                
                <div class="result-box">
                    <h3>üìã Homebox-Konfiguration:</h3>
                    <ol style="line-height: 2; padding-left: 20px;">
                        <li><strong>http://o2.box</strong> aufrufen</li>
                        <li><strong>Internet ‚Üí Internetzugang</strong></li>
                        <li><strong>Anbieter:</strong> o2</li>
                        <li><strong>Anschlussart:</strong> Glasfaser (FTTH)</li>
                        <li><strong>√úbernehmen</strong> ‚Üí Router startet neu</li>
                    </ol>
                </div>

                <div class="info-box tip">
                    <strong>üí° LED-Status Homebox:</strong>
                    <ul style="margin-top: 10px; padding-left: 20px;">
                        <li>Power LED: gr√ºn = OK</li>
                        <li>Internet LED: gr√ºn = verbunden</li>
                        <li>WLAN LED: gr√ºn = aktiv</li>
                    </ul>
                </div>

                <div class="button-group">
                    <button class="btn-primary btn" onclick="nextStep('step8-verbindung')">
                        ‚û°Ô∏è Weiter zur Verbindungspr√ºfung
                    </button>
                </div>
            </div>

            <!-- STEP 8: Verbindung testen -->
            <div class="step" id="step8-verbindung">
                <h2 class="question">üåê Verbindung testen</h2>
                
                <div class="info-box tip">
                    <strong>üí° Wie testen?</strong>
                    <ol style="margin-top: 10px; padding-left: 20px;">
                        <li>Kunde soll <strong>www.google.de</strong> aufrufen</li>
                        <li>Oder: Router-Men√º ‚Üí Internet ‚Üí Online-Monitor</li>
                    </ol>
                </div>

                <div class="button-group">
                    <button class="btn" onclick="setVerbindung('ok')">
                        ‚úÖ Verbindung OK - Internet funktioniert!
                    </button>
                    <button class="btn" onclick="setVerbindung('nok')">
                        ‚ùå Verbindung NOK - Kein Internet
                    </button>
                </div>
            </div>

            <!-- STEP 9: Portreset durchf√ºhren -->
            <div class="step" id="step9-portreset">
                <h2 class="question">üîÑ Portreset durchf√ºhren</h2>
                
                <div class="info-box warning">
                    <strong>‚ö†Ô∏è Wichtig:</strong>
                    Portreset immer VOR Eskalation an UGG durchf√ºhren!
                </div>

                <div class="result-box">
                    <h3>üìã Portreset-Anleitung:</h3>
                    <ol style="line-height: 2; padding-left: 20px;">
                        <li><strong>In TITAN:</strong> Portreset-Funktion aufrufen</li>
                        <li><strong>Parallel:</strong> ONT + Router 10 Sekunden vom Strom trennen</li>
                        <li><strong>Warten:</strong> 30 Sekunden</li>
                        <li><strong>Einschalten:</strong> Erst ONT, dann Router</li>
                        <li><strong>Warten:</strong> 3-5 Minuten (ONT Sync + Router Boot)</li>
                        <li><strong>Testen:</strong> Verbindung erneut pr√ºfen</li>
                    </ol>
                </div>

                <div class="button-group">
                    <button class="btn" onclick="setPortreset('ok')">
                        ‚úÖ Nach Portreset: Internet funktioniert!
                    </button>
                    <button class="btn" onclick="setPortreset('nok')">
                        ‚ùå Nach Portreset: Immer noch kein Internet
                    </button>
                </div>
            </div>

            <!-- STEP 10: Komplettausfall bearbeiten -->
            <div class="step" id="step10-komplettausfall">
                <h2 class="question">üî¥ Komplettausfall bearbeiten</h2>
                
                <div class="info-box warning">
                    <strong>‚ö†Ô∏è Definition Komplettausfall:</strong>
                    Kunde hat GAR KEIN Internet mehr (nicht nur langsam)
                </div>

                <h3 style="margin: 20px 0;">Quick-Checks:</h3>
                
                <div class="checklist">
                    <div class="checklist-item">
                        <input type="checkbox" id="kcheck1">
                        <label for="kcheck1">ONT LEDs gepr√ºft?</label>
                    </div>
                    <div class="checklist-item">
                        <input type="checkbox" id="kcheck2">
                        <label for="kcheck2">Router-Verkabelung OK?</label>
                    </div>
                    <div class="checklist-item">
                        <input type="checkbox" id="kcheck3">
                        <label for="kcheck3">Router neu gestartet?</label>
                    </div>
                    <div class="checklist-item">
                        <input type="checkbox" id="kcheck4">
                        <label for="kcheck4">Portreset durchgef√ºhrt?</label>
                    </div>
                </div>

                <div class="button-group">
                    <button class="btn" onclick="komplettausfallResolved()">
                        ‚úÖ Problem gel√∂st - Internet l√§uft wieder
                    </button>
                    <button class="btn" onclick="komplettausfallEskalieren()">
                        üìã An LineOwner eskalieren (STM erstellen)
                    </button>
                </div>
            </div>

            <!-- STEP 11: Sporadische Ausf√§lle -->
            <div class="step" id="step11-sporadisch">
                <h2 class="question">üü° Sporadische Ausf√§lle bearbeiten</h2>
                
                <div class="info-box warning">
                    <strong>‚ö†Ô∏è Definition:</strong>
                    Verbindung bricht immer wieder ab, aber kommt zur√ºck
                </div>

                <h3 style="margin: 20px 0;">H√§ufige Ursachen:</h3>
                
                <div class="info-box tip">
                    <strong>1Ô∏è‚É£ 171 LAC-Fehler pr√ºfen:</strong><br>
                    <ul style="margin-top: 10px; padding-left: 20px;">
                        <li>In TITAN: 171 LAC Log anschauen</li>
                        <li>Fehlercode dokumentieren</li>
                        <li>Im Ticket als Fehlerbeschreibung aufnehmen</li>
                    </ul>
                </div>

                <div class="info-box tip">
                    <strong>2Ô∏è‚É£ √úberhitzung:</strong><br>
                    Router steht in geschlossenem Schrank? ‚Üí Bel√ºftung pr√ºfen
                </div>

                <div class="info-box tip">
                    <strong>3Ô∏è‚É£ Defekte Hardware:</strong><br>
                    Router-LEDs flackern? ‚Üí Austausch n√∂tig
                </div>

                <div class="button-group">
                    <button class="btn" onclick="sporadischWFC()">
                        ‚è∏Ô∏è WFC (Kunde soll 24-48h beobachten)
                    </button>
                    <button class="btn" onclick="sporadischEskalieren()">
                        üìã An LineOwner eskalieren
                    </button>
                </div>
            </div>

            <!-- STEP 12: Performance-Probleme -->
            <div class="step" id="step12-performance">
                <h2 class="question">üêå Performance-Probleme bearbeiten</h2>
                
                <div class="info-box tip">
                    <strong>üí° Wichtig:</strong>
                    Erst Schwellenwerte pr√ºfen, bevor du eskalierst!
                </div>

                <h3 style="margin: 20px 0;">Schwellenwerte:</h3>
                
                <div class="result-box">
                    <table style="width: 100%; border-collapse: collapse;">
                        <tr style="background: #f0f0f0;">
                            <th style="padding: 10px; text-align: left; border: 1px solid #ddd;">Tarif</th>
                            <th style="padding: 10px; text-align: left; border: 1px solid #ddd;">Min. Download</th>
                            <th style="padding: 10px; text-align: left; border: 1px solid #ddd;">Min. Upload</th>
                        </tr>
                        <tr>
                            <td style="padding: 10px; border: 1px solid #ddd;">50 Mbit/s</td>
                            <td style="padding: 10px; border: 1px solid #ddd;">25 Mbit/s (50%)</td>
                            <td style="padding: 10px; border: 1px solid #ddd;">5 Mbit/s (50%)</td>
                        </tr>
                        <tr>
                            <td style="padding: 10px; border: 1px solid #ddd;">100 Mbit/s</td>
                            <td style="padding: 10px; border: 1px solid #ddd;">50 Mbit/s (50%)</td>
                            <td style="padding: 10px; border: 1px solid #ddd;">20 Mbit/s (50%)</td>
                        </tr>
                        <tr>
                            <td style="padding: 10px; border: 1px solid #ddd;">250 Mbit/s</td>
                            <td style="padding: 10px; border: 1px solid #ddd;">125 Mbit/s (50%)</td>
                            <td style="padding: 10px; border: 1px solid #ddd;">20 Mbit/s (40%)</td>
                        </tr>
                        <tr>
                            <td style="padding: 10px; border: 1px solid #ddd;">1000 Mbit/s</td>
                            <td style="padding: 10px; border: 1px solid #ddd;">500 Mbit/s (50%)</td>
                            <td style="padding: 10px; border: 1px solid #ddd;">100 Mbit/s (20%)</td>
                        </tr>
                    </table>
                </div>

                <div class="info-box warning">
                    <strong>‚ö†Ô∏è Wichtig:</strong>
                    Speedtest IMMER per LAN-Kabel machen, nicht WLAN!
                </div>

                <div class="input-group">
                    <label>Gebuchter Tarif:</label>
                    <select id="tarif">
                        <option value="50">50 Mbit/s</option>
                        <option value="100">100 Mbit/s</option>
                        <option value="250">250 Mbit/s</option>
                        <option value="1000">1000 Mbit/s (1 Gbit/s)</option>
                    </select>
                </div>

                <div class="input-group">
                    <label>Gemessener Download (Mbit/s):</label>
                    <input type="number" id="download" placeholder="z.B. 45">
                </div>

                <div class="input-group">
                    <label>Gemessener Upload (Mbit/s):</label>
                    <input type="number" id="upload" placeholder="z.B. 8">
                </div>

                <div class="button-group">
                    <button class="btn-primary btn" onclick="checkPerformance()">
                        üîç Schwellenwerte pr√ºfen
                    </button>
                </div>

                <div id="performanceResult"></div>
            </div>

            <!-- FINAL RESULT: Ticket schlie√üen -->
            <div class="step" id="final-success">
                <h2 class="question">‚úÖ Ticket erfolgreich bearbeitet!</h2>
                
                <div class="info-box success">
                    <strong>üéâ Gl√ºckwunsch!</strong>
                    Problem gel√∂st - Kunde ist zufrieden!
                </div>

                <div class="result-box">
                    <h3>üìã Ticket-Dokumentation (Copy & Paste):</h3>
                    <pre id="finalDocumentation"></pre>
                    <button class="copy-btn" onclick="copyToClipboard('finalDocumentation')">
                        üìã Text kopieren
                    </button>
                </div>

                <div class="info-box tip">
                    <strong>üí° N√§chste Schritte:</strong>
                    <ol style="margin-top: 10px; padding-left: 20px;">
                        <li>Text in Ticket einf√ºgen</li>
                        <li>Ticket schlie√üen</li>
                        <li>Optional: Courtesy Call beim Kunden (falls angebracht)</li>
                    </ol>
                </div>

                <button class="btn-restart" onclick="restart()">
                    üîÑ Neues Ticket bearbeiten
                </button>
            </div>

            <!-- FINAL RESULT: WFC -->
            <div class="step" id="final-wfc">
                <h2 class="question">‚è∏Ô∏è Ticket ins WFC</h2>
                
                <div class="info-box warning">
                    <strong>‚ö†Ô∏è Waiting for Close:</strong>
                    Kunde soll Anschluss 24-48h beobachten
                </div>

                <div class="result-box">
                    <h3>üìã WFC-Dokumentation (Copy & Paste):</h3>
                    <pre id="wfcDocumentation"></pre>
                    <button class="copy-btn" onclick="copyToClipboard('wfcDocumentation')">
                        üìã Text kopieren
                    </button>
                </div>

                <div class="info-box tip">
                    <strong>üí° N√§chste Schritte:</strong>
                    <ol style="margin-top: 10px; padding-left: 20px;">
                        <li>Text in Ticket einf√ºgen</li>
                        <li>Ticket-Status: WFC setzen</li>
                        <li>Wiedervorlage: In 48h</li>
                        <li>Wenn Kunde sich meldet: Erneut pr√ºfen</li>
                    </ol>
                </div>

                <button class="btn-restart" onclick="restart()">
                    üîÑ Neues Ticket bearbeiten
                </button>
            </div>

            <!-- FINAL RESULT: STM erstellen -->
            <div class="step" id="final-stm">
                <h2 class="question">üìã STM erstellen</h2>
                
                <div class="info-box warning">
                    <strong>‚ö†Ô∏è Eskalation an LineOwner:</strong>
                    <span id="stmLineOwner"></span>
                </div>

                <div class="result-box">
                    <h3>üìã STM-Text (Copy & Paste):</h3>
                    <pre id="stmDocumentation"></pre>
                    <button class="copy-btn" onclick="copyToClipboard('stmDocumentation')">
                        üìã Text kopieren
                    </button>
                </div>

                <div class="info-box tip">
                    <strong>üí° STM erstellen:</strong>
                    <ol style="margin-top: 10px; padding-left: 20px;">
                        <li>In TITAN: STM-Funktion aufrufen</li>
                        <li>LineOwner: <strong id="stmLineOwner2"></strong></li>
                        <li>Fehlertext aus Textbaustein einf√ºgen</li>
                        <li>Termin: <strong id="stmTermin">OHNE Termin (bei Anschaltung)</strong></li>
                        <li>STM absenden</li>
                        <li>Ticket-Status: "In Bearbeitung LineOwner"</li>
                    </ol>
                </div>

                <button class="btn-restart" onclick="restart()">
                    üîÑ Neues Ticket bearbeiten
                </button>
            </div>

            <!-- FINAL RESULT: Kunde kontaktieren -->
            <div class="step" id="final-contact">
                <h2 class="question">üìû Kunde kontaktieren</h2>
                
                <div class="info-box warning">
                    <strong>‚ö†Ô∏è Mehr Infos n√∂tig:</strong>
                    Ohne Kundengespr√§ch kann das Ticket nicht bearbeitet werden!
                </div>

                <div class="result-box">
                    <h3>üìã Was im Gespr√§ch kl√§ren:</h3>
                    <ul style="line-height: 2; padding-left: 20px;">
                        <li>Wann war der letzte erfolgreiche Verbindungsaufbau?</li>
                        <li>Gab es einen l√§ngeren Urlaub/Abwesenheit?</li>
                        <li>War die Leitung jemals im Betrieb? (bei Anschaltung)</li>
                        <li>Welche Fehlermeldungen erscheinen am Router?</li>
                        <li>ONT LED-Status gemeinsam pr√ºfen</li>
                    </ul>
                </div>

                <div class="info-box tip">
                    <strong>üí° Nach dem Gespr√§ch:</strong>
                    Troubleshooter erneut durchlaufen mit den neuen Infos!
                </div>

                <button class="btn-restart" onclick="restart()">
                    üîÑ Troubleshooter neu starten
                </button>
            </div>

            <!-- NAVIGATION -->
            <div class="nav-buttons" id="navButtons">
                <button class="btn-back" onclick="previousStep()" id="backButton">
                    ‚¨ÖÔ∏è Zur√ºck
                </button>
                <button class="btn-restart" onclick="restart()">
                    üîÑ Von vorne
                </button>
            </div>
        </div>
    </div>

    <script>
        // ===== GLOBALE VARIABLEN =====
        let currentStep = 1;
        let maxSteps = 10;
        let history = ['step1']; // F√ºr Back-Button
        
        let data = {
            lineId: '',
            lineOwner: '',
            hasActivity: null,
            hasAnschaltdatum: null,
            ticketType: '',
            routerModel: '',
            verkabelung: '',
            ontStatus: '',
            verbindung: '',
            portreset: ''
        };

        // ===== PROGRESS BAR UPDATE =====
        function updateProgress() {
            const progress = (currentStep / maxSteps) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('progressText').textContent = `Schritt ${currentStep} von ${maxSteps}`;
        }

        // ===== STEP NAVIGATION =====
        function showStep(stepId) {
            // Alle Steps verstecken
            document.querySelectorAll('.step').forEach(step => {
                step.classList.remove('active');
            });
            
            // Gew√ºnschten Step zeigen
            document.getElementById(stepId).classList.add('active');
            
            // History updaten
            if (history[history.length - 1] !== stepId) {
                history.push(stepId);
            }
            
            // Back-Button anzeigen/verstecken
            document.getElementById('backButton').style.display = 
                history.length > 1 ? 'block' : 'none';
            
            // Scroll to top
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        function nextStep(stepId) {
            currentStep++;
            updateProgress();
            showStep(stepId);
        }

        function previousStep() {
            if (history.length > 1) {
                history.pop(); // Aktuellen Step entfernen
                const prevStep = history[history.length - 1];
                currentStep--;
                updateProgress();
                showStep(prevStep);
            }
        }

        // ===== STEP 1: LineOwner =====
        function setLineOwner(owner) {
            data.lineOwner = owner;
            data.lineId = document.getElementById('lineId').value;
            nextStep('step2');
        }

        // ===== STEP 2: Aktivit√§t =====
        function setActivity(activity) {
            data.hasActivity = activity;
            
            if (activity === 'yes') {
                // Hat Aktivit√§t ‚Üí St√∂rung ‚Üí St√∂rungstyp w√§hlen
                nextStep('step3');
            } else if (activity === 'no') {
                // Keine Aktivit√§t ‚Üí Anschaltdatum pr√ºfen
                nextStep('step2b');
            } else {
                // Unsicher ‚Üí Kunde kontaktieren
                showStep('final-contact');
            }
        }

        // ===== STEP 2b: Anschaltdatum =====
        function setAnschaltdatum(hasDate) {
            data.hasAnschaltdatum = hasDate;
            
            if (hasDate === 'yes') {
                // Anschaltdatum bekannt ‚Üí Zu Anschaltung
                data.ticketType = 'anschaltung';
                nextStep('step4-router');
            } else {
                // Kein Datum ‚Üí Kunde kontaktieren
                showStep('final-contact');
            }
        }

        // ===== STEP 3: St√∂rungstyp =====
        function setTicketType(type) {
            data.ticketType = type;
            
            if (type === 'anschaltung') {
                nextStep('step4-router');
            } else if (type === 'komplettausfall') {
                nextStep('step10-komplettausfall');
            } else if (type === 'sporadisch') {
                nextStep('step11-sporadisch');
            } else if (type === 'performance') {
                nextStep('step12-performance');
            }
        }

        // ===== STEP 4: Router-Modell =====
        function setRouterModel(model) {
            data.routerModel = model;
            nextStep('step5-verkabelung');
        }

        // ===== STEP 5: Verkabelung =====
        function checkVerkabelung(type) {
            data.verkabelung = type;
            nextStep('step6-ont');
        }

        // ===== STEP 6: ONT Status =====
        function setONTStatus(status) {
            data.ontStatus = status;
            
            if (status === 'kein-strom') {
                // Kein Strom ‚Üí Kunde muss Strom pr√ºfen
                alert('‚ö†Ô∏è Kunde muss Stromversorgung am ONT pr√ºfen!\n\nDanach Troubleshooter erneut durchlaufen.');
                return;
            }
            
            // Weiter zur Router-Konfiguration
            if (data.routerModel === 'fritzbox') {
                nextStep('step7-fritzbox');
            } else if (data.routerModel === 'homebox') {
                nextStep('step7-homebox');
            } else {
                // Dritthersteller-Router
                alert('‚ö†Ô∏è Dritthersteller-Router:\n\nBitte Bedienungsanleitung des Routers zur Konfiguration nutzen.\n\nAllgemein: o2 als Anbieter w√§hlen, Glasfaser/FTTH als Anschlussart.');
                nextStep('step8-verbindung');
            }
        }

        // ===== STEP 8: Verbindung =====
        function setVerbindung(status) {
            data.verbindung = status;
            
            if (status === 'ok') {
                // Verbindung OK ‚Üí Erfolg!
                generateSuccessDocumentation();
                showStep('final-success');
            } else {
                // Verbindung NOK ‚Üí Portreset
                nextStep('step9-portreset');
            }
        }

        // ===== STEP 9: Portreset =====
        function setPortreset(status) {
            data.portreset = status;
            
            if (status === 'ok') {
                // Nach Portreset OK ‚Üí Erfolg!
                generateSuccessDocumentation();
                showStep('final-success');
            } else {
                // Nach Portreset NOK ‚Üí STM
                generateSTMDocumentation('anschaltung');
                showStep('final-stm');
            }
        }

        // ===== STEP 10: Komplettausfall =====
        function komplettausfallResolved() {
            generateSuccessDocumentation();
            showStep('final-success');
        }

        function komplettausfallEskalieren() {
            generateSTMDocumentation('komplettausfall');
            showStep('final-stm');
        }

        // ===== STEP 11: Sporadisch =====
        function sporadischWFC() {
            generateWFCDocumentation('sporadisch');
            showStep('final-wfc');
        }

        function sporadischEskalieren() {
            generateSTMDocumentation('sporadisch');
            showStep('final-stm');
        }

        // ===== STEP 12: Performance =====
        function checkPerformance() {
            const tarif = parseInt(document.getElementById('tarif').value);
            const download = parseFloat(document.getElementById('download').value);
            const upload = parseFloat(document.getElementById('upload').value);
            
            if (!download || !upload) {
                alert('‚ö†Ô∏è Bitte beide Werte eingeben!');
                return;
            }
            
            // Schwellenwerte berechnen
            let minDownload, minUpload;
            
            switch(tarif) {
                case 50:
                    minDownload = 25;
                    minUpload = 5;
                    break;
                case 100:
                    minDownload = 50;
                    minUpload = 20;
                    break;
                case 250:
                    minDownload = 125;
                    minUpload = 20;
                    break;
                case 1000:
                    minDownload = 500;
                    minUpload = 100;
                    break;
            }
            
            const downloadOK = download >= minDownload;
            const uploadOK = upload >= minUpload;
            
            const resultDiv = document.getElementById('performanceResult');
            
            if (downloadOK && uploadOK) {
                resultDiv.innerHTML = `
                    <div class="info-box success" style="margin-top: 20px;">
                        <strong>‚úÖ Werte im gr√ºnen Bereich!</strong><br><br>
                        Download: ${download} Mbit/s (Min: ${minDownload} Mbit/s) ‚úÖ<br>
                        Upload: ${upload} Mbit/s (Min: ${minUpload} Mbit/s) ‚úÖ<br><br>
                        <strong>‚Üí Keine St√∂rung!</strong> Kunde hat die gebuchte Leistung.
                    </div>
                    <div class="button-group" style="margin-top: 20px;">
                        <button class="btn-primary btn" onclick="performanceResolved()">
                            ‚úÖ Ticket schlie√üen
                        </button>
                    </div>
                `;
            } else {
                resultDiv.innerHTML = `
                    <div class="info-box error" style="margin-top: 20px;">
                        <strong>‚ùå Werte UNTER Schwellenwert!</strong><br><br>
                        Download: ${download} Mbit/s (Min: ${minDownload} Mbit/s) ${downloadOK ? '‚úÖ' : '‚ùå'}<br>
                        Upload: ${upload} Mbit/s (Min: ${minUpload} Mbit/s) ${uploadOK ? '‚úÖ' : '‚ùå'}<br><br>
                        <strong>‚Üí STM an LineOwner erstellen!</strong>
                    </div>
                    <div class="button-group" style="margin-top: 20px;">
                        <button class="btn-primary btn" onclick="performanceEskalieren(${download}, ${upload}, ${minDownload}, ${minUpload})">
                            üìã STM erstellen
                        </button>
                    </div>
                `;
            }
        }

        function performanceResolved() {
            generateSuccessDocumentation();
            showStep('final-success');
        }

        function performanceEskalieren(download, upload, minDownload, minUpload) {
            data.performanceData = { download, upload, minDownload, minUpload };
            generateSTMDocumentation('performance');
            showStep('final-stm');
        }

        // ===== DOKUMENTATION GENERIEREN =====
        function generateSuccessDocumentation() {
            const doc = `
=== TICKET ERFOLGREICH BEARBEITET ===

LineOwner: ${data.lineOwner}
${data.lineId ? 'LineID: ' + data.lineId : ''}
Ticket-Typ: ${data.ticketType}

Durchgef√ºhrte Ma√ünahmen:
${data.routerModel ? '- Router konfiguriert (' + data.routerModel + ')' : ''}
${data.ontStatus ? '- ONT Status gepr√ºft: ' + data.ontStatus : ''}
${data.portreset === 'ok' ? '- Portreset durchgef√ºhrt (erfolgreich)' : ''}
- Verbindung erfolgreich hergestellt

Kunde ist online und zufrieden.
Ticket kann geschlossen werden.

${new Date().toLocaleString('de-DE')}
            `.trim();
            
            document.getElementById('finalDocumentation').textContent = doc;
        }

        function generateWFCDocumentation(type) {
            let doc = '';
            
            if (type === 'sporadisch') {
                const kundeErreicht = confirm('Kunde erreicht? OK = Ja, Abbrechen = Nein');
                
                doc = `
=== TICKET INS WFC ===

LineOwner: ${data.lineOwner}
${data.lineId ? 'LineID: ' + data.lineId : ''}

Kunde ${kundeErreicht ? 'erreicht' : 'nicht erreicht'}.

Durchgef√ºhrte Ma√ünahmen:
- Portreset durchgef√ºhrt
- 171 LAC Log gepr√ºft

Kunde soll Anschluss f√ºr 24-48h auf weitere Abbr√ºche beobachten.

${kundeErreicht ? 
'Wenn weiterhin NOK: STM an LineOwner.' :
'Wenn weiterhin NOK: Neuen Termin vereinbaren, Ticket als Reklamation an LineOwner.'}

Wiedervorlage: ${new Date(Date.now() + 48*60*60*1000).toLocaleDateString('de-DE')}

${new Date().toLocaleString('de-DE')}
                `.trim();
            }
            
            document.getElementById('wfcDocumentation').textContent = doc;
        }

        function generateSTMDocumentation(type) {
            document.getElementById('stmLineOwner').textContent = data.lineOwner;
            document.getElementById('stmLineOwner2').textContent = data.lineOwner;
            
            let doc = '';
            let termin = '';
            
            if (type === 'anschaltung') {
                termin = 'OHNE Termin';
                doc = `
=== STM AN ${data.lineOwner.toUpperCase()} ===

Anschaltung - Kein Signal am ONT

LineID: ${data.lineId || '[Hier eintragen]'}

Sachverhalt:
- FTTH-Anschaltung
- Router konfiguriert (${data.routerModel})
- ONT Status: ${data.ontStatus}
- Portreset + Stromreset durchgef√ºhrt
- Keine Verbindung herstellbar

Bitte Leitung pr√ºfen und Signal schalten.

${new Date().toLocaleString('de-DE')}
                `.trim();
            } else if (type === 'komplettausfall') {
                termin = 'MIT Termin (in Absprache mit Kunde)';
                doc = `
=== STM AN ${data.lineOwner.toUpperCase()} ===

Komplettausfall - Kein Internet

LineID: ${data.lineId || '[Hier eintragen]'}

Sachverhalt:
- Kunde komplett offline seit [Datum eintragen]
- ONT Status gepr√ºft: [Status eintragen]
- Router neu gestartet
- Portreset durchgef√ºhrt
- Keine Verbindung herstellbar

Bitte Leitung pr√ºfen.

Termin: [Mit Kunde vereinbaren]

${new Date().toLocaleString('de-DE')}
                `.trim();
            } else if (type === 'sporadisch') {
                termin = 'MIT Termin (in Absprache mit Kunde)';
                doc = `
=== STM AN ${data.lineOwner.toUpperCase()} ===

Sporadische Verbindungsabbr√ºche

LineID: ${data.lineId || '[Hier eintragen]'}

Sachverhalt:
- Verbindung bricht wiederholt ab
- 171 LAC Fehlercode: [Code eintragen]
- Portreset durchgef√ºhrt
- Problem besteht weiterhin

Bitte Leitung auf St√∂rungen pr√ºfen.

Termin: [Mit Kunde vereinbaren]

${new Date().toLocaleString('de-DE')}
                `.trim();
            } else if (type === 'performance') {
                const perf = data.performanceData;
                termin = 'MIT Termin (in Absprache mit Kunde)';
                doc = `
=== STM AN ${data.lineOwner.toUpperCase()} ===

Performance unter Schwellenwert

LineID: ${data.lineId || '[Hier eintragen]'}

Sachverhalt:
- Speedtest per LAN durchgef√ºhrt
- Download: ${perf.download} Mbit/s (Min: ${perf.minDownload} Mbit/s)
- Upload: ${perf.upload} Mbit/s
